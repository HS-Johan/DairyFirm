@{
	Layout = "/Views/Shared/_AdminLayout.cshtml";
}

@model IEnumerable<DairyFirmView.ViewModel.VaccineInfoVM>

<div class="card shadow-sm border-0">

	<div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
		<h3 class="card-title mb-0 col-10"><i class="me-2"></i>Vaccine List</h3>
		<a asp-action="CreateVaccine" class="btn btn-dark btn-sm">
			<i class="fas fa-plus"></i> Add New Vaccine
		</a>
	</div>

	<div class="card-body">
		<table id="vaccineTable" class="table table-striped table-bordered table-hover w-100">
			<thead class="table-info text-center align-middle">
				<tr>
					<th>Serial</th>
					<th>Vaccine Name</th>
					<th>Vaccine Price</th>
					<th>Total Vaccine</th>
					<th>Vaccine Month</th>
					<th>Vaccine Day</th>
					<th>Action</th>
				</tr>
			</thead>

			<tbody class="align-middle">
				@{
					int serial = 1;
					foreach (var data in Model)
					{
						<tr>
							<td class="text-center">@serial</td>
							<td>@data.VaccineName</td>
							<td>@data.VaccinePrice</td>
							<td>@data.TotalVaccine</td>
							<td>@data.VaccineMonth</td>
							<td>@data.VaccineDay</td>
							<td class="text-center">
								<a class="btn btn-info btn-sm" asp-action="VaccineDetails" asp-route-id="@data.VaccineId" title="View Details">
									<i class="fas fa-eye"></i>
								</a>
								<a class="btn btn-success btn-sm" asp-action="VaccineEdit" asp-route-id="@data.VaccineId" title="Edit Vaccine">
									<i class="fas fa-edit"></i>
								</a>
								<a class="btn btn-danger btn-sm btn_dlt" data-id="@data.VaccineId" title="Delete Vaccine">
									<i class="fas fa-trash-alt"></i>
								</a>
							</td>
						</tr>
						serial++;
					}
				}
			</tbody>
		</table>
	</div>
</div>

@section Scripts {

	<script>

		$(document).on('click', '.btn_dlt', function()
			{
				var vaccineId = $(this).data('id');

				var row = $(this).closest('tr');

				console.log(vaccineId);

				Swal.fire
				(
					{
						title: "Are you sure?",
						text: "You won't be able to revert this!",
						icon: "warning",
						showCancelButton: true,
						confirmButtonColor: "#3085d6",
						cancelButtonColor: "#d33",
						confirmButtonText: "Yes, delete it!"
					}
				)
				.then
				(
					(result) =>
					{
						if (result.isConfirmed)
						{
							$.ajax
							(
								{
									url: '/VaccineView/Delete/' + vaccineId,
									type: 'POST',
									success: function(responce)
									{
										row.remove();
										Swal.fire
										(
											{
												title: responce.head,
												text: responce.body,
												icon: responce.icon
											}
										);
									},
									error: function()
									{
										console.log("Error");
									}
								}
							)
						}
					}
				);
			}
		);

	</script>

}
